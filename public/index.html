<!DOCTYPE html>
<html ng-app="nirc" ng-controller="RootCtrl">
  <head>
    <title>nirc</title>
    <script src='/socket.io/socket.io.js'></script>
    <script src='/javascripts/vendor/mousetrap.min.js'></script>
    <script src='/javascripts/vendor/angular.min.js'></script>
    <script src='/javascripts/vendor/angular-sanitize.min.js'></script>
    <script src='/javascripts/vendor/lodash.min.js'></script>
    <script src='/javascripts/nirc.js'></script>
    <script src='/javascripts/nirc.templates.js'></script>
    <link href='//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css' rel='stylesheet'>
    <link href='/stylesheets/style.css' media='screen' rel='stylesheet' type='text/css'/>
    <link ng-href='/stylesheets/themes/{{theme}}/theme.css' media='screen' rel='stylesheet' type='text/css'/>
  </head>
  <body ng-controller="MainCtrl">
    <!-- config overlay -->
    <div class="overlay" ng-if="!client.connected">
      <div ng-include="'templates/config.html'"></div>
    </div>

    <!-- channel/status tabbar  -->
    <ul class="tabbar" ng-controller="TabCtrl">
      <li class="logo">
        nIRC
        <a class="dropdown-toggle" href ng-click="toggleExpand()">
          <i class="fa fa-fw"
             ng-class="{'fa-caret-down': expanded, 'fa-caret-right': !expanded}"></i>
        </a>
      </li>
      <li ng-class="{active: isActive(client.statusChannel)}"
          ng-show="expanded || isActive(client.statusChannel)">
        <a href ng-click="setActive(client.statusChannel)" class="channel">
          <i class="fa fa-fw" ng-class="iconFor(client.statusChannel)"></i>
          status
        </a>
      </li>
      <li ng-repeat="channel in client.channels" ng-class="{active: isActive(channel)}"
          ng-show="expanded || isActive(channel)">
        <a href ng-click="setActive(channel)" class="channel">
          <i class="fa fa-fw" ng-class="iconFor(channel)"></i>
          {{channel.name}}
        </a>
        <a href ng-click="closeTab(channel)" class="close">
          <i class="fa fa-fw fa-times"></i>
        </a>
      </li>
      <li class="theme-selector" ng-show="expanded">
        <select ng-model="theme" ng-options="t for t in themes" ng-change="setTheme(theme)"></select>
      </li>
    </ul>

    <div class="wrapper">
      <!-- main content pane -->
      <ul class="content" scroll-glue>
        <li ng-repeat="event in client.activeChannel.history">
          <span class="timestamp">
            {{event.timestamp | date:'HH:mm:ss'}}
          </span>
          <span class="sender">
            {{event.from.nick}}:
          </span>
          <span class="message" ng-bind-html="event.message | linky:'_blank'"></span>
        </li>
      </ul>
      <!-- user list -->
      <ul class="users" ng-controller="UserCtrl">
        <li ng-repeat="user in client.activeChannel.users">
          <a ng-click="messageTo(user)" href>{{user.nick}}</a>
        </li>
      </ul>
    </div>

    <input type="text" class="user-input" read-line="client.say(text)"
           complete-from="client.activeChannel.users">
  </body>
</html>
